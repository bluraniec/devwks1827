## Chapter 3.2 - SERVICE CREATION (XML TEMPLATE)
> Designed! Congratz! :boom:  
> Time to make it real! Let's create our ACL_SERVICE! :construction_worker:

### 2nd step - Create XML TEMPLATE

First part is an XML template of our Service - this will be an actual config pushed to the device.

<img src="/readme/temp.png"></img>

This is an initial XML template generated by default: <br>
<p align="center">
<img width=460 src="/readme/xml_init.png"></img>
</p>

Log in back to NSO:
```
ncs_cli -C -u admin
```

Go into config mode:
```
config
```

Put sample config on NSO CLI and generate XML from it.

First for IOS device:
```
devices device IOS0 config ios:ip access-list standard ACL_CLUS
permit 172.16.0.0 0.0.255.255
deny 192.168.34.0 0.0.0.255

devices device IOS0 config ios:interface GigabitEthernet 0/0
ip access-group ACL_CLUS in
```

Print this configuration as XML:
```
commit dry-run outformat xml
```

Copy all output between **<config\>** **</config\>** tags from the CLI and paste it to our initial XML template **ACL_SERVICE-template.xml** as well between **<config\>** **</config\>** tags:
<img src="init temp.png"></img>

Great! We only wanted to generate the structure of XML. Don't commit that configuration to the device, abort it:
```
admin@ncs(config-if)# abort
```

Go again to the config mode:
```
admin@ncs# config
```

And repeat all steps for IOS-XR:
```
devices device IOS_XR0 config cisco-ios-xr:ipv4 access-list ACL_CLUS
10 permit 172.16.0.0 0.0.255.255
20 deny 192.168.34.0 0.0.0.255

devices device IOS_XR0 config cisco-ios-xr:interface GigabitEthernet 0/0
ipv4 access-group ACL_CLUS ingress
```

As well as Juniper:
```
devices device JUN0 config junos:configuration firewall family inet filter ACL_CLUS 
term 10 from source-address 172.16.0.0/16
exit
then accept
exit
term 20 from source-address 192.168.34.0/24
exit
then reject

devices device JUN0 config junos:configuration interfaces interface xe-0/0/0 unit 0 family inet filter input filter-name ACL_CLUS
```

Once you're done - the complete template **ACL_SERVICE-template.xml** with our ACL configs for IOS, IOS-XR and JUNIPER should looks like that (with configs for all vendors pasted one by one):
<p align="center">
<img width=640 src="/readme/template_full.png"></img>
</p>

Congratz! You have prepared all devices configuration for our Service! But wait... there're now fixed values. 

Let's update the template with our parametrized **variables** from the previous Chapter - **interface** and **direction**!

Parameter | IOS  | XR | Junos
------------ | ------------- | ------------- | -------------
interface | GigabitEthernet `[int_number]` | GigabitEthernet `[int_number]` | `[int]`
direction | `[in/out]` | `[in/out]` | `[input/output]`  

IOS:
<img src="/readme/iosparam.png"></img>

Do it as well for IOS-XR. It's very similar to IOS:
<img src="/readme/xrparam.png"></img>

Juniper requires a little bit different change. 
Parametrization of the **interface** will be the same but **direction** here is not a value (like 'input'/'output') - it's an **XML tag**, so you need to use **when statement** to be able to activate the particular, desired tag:
<img src="/readme/junparam.png"></img>

That's it, we're done with templating! Congratz!

<h4 align="center">[7/12]</h4>
<h4 align="center"> <a href="/readme/5.md"> :arrow_left: Create Service Skeleton! </a> || <a href="/readme/5b.md"> Create Service YANG Data Model! :arrow_right: </a> </h4>
