## 5th step - CUSTOM UI
> Done! You created first NSO Service - ACL Service!  
> Moreover - you can create your own applications on top of NSO!  
> Sky is the limit! :partly_sunny:

By the usage of **RESTCONF** protocol, you can build various apps on top of NSO that will be called via REST operations like GET/POST/DELETE etc. Open API gives way much more possibilities!

For example - **Network Engineers** are comfortable with the **CLI** but **Customers** doesn't really want to see the CLI in the XXI century. They would love to see customized **User Interface** and be able to configure network by clicking the button in the website.

In Carl's scenario - when he will be on his PTO - there will be no one in his company with enough networking knowledge to remove ACL_CLUS from the whole network of different devices. What if he will have a website with a **Button** that will remove after one-click all ACL_CLUS configs from all devices in the Network? Sounds great!

This is the design of our **Custom Web UI**:
<img src="/readme/ui1.png"></img>

Website has pre-prepared functionalities like:
- **Show devices** - shows devices onboarded in NSO (device, address, port, platform)
- **Get ACLs** - shows deployed ACLs by the ACL_SERVICE (device, interface, direction)
- **Set ACLs** - form to deploy ACL_SERVICE (device, interface, direction)  
- **Delete ACLs** - removes from the whole network all configs deployed by ACL_SERVICE instances

All of these are just rendered **RESTCONF Responses**!

Django project skeleton structure looks following:
```
/nso-ui
├── Dockerfile
├── requirements.txt
├── manage.py
├── portal
    ├── settings.py
    ├── urls.py
    ├── wsgi.py
    └── __init__.py
└── app
    ├── admin.py
    ├── apps.py
    ├── models.py
    ├── tests.py
    ├── views.py
    ├── migrations
    └── templates
        ├── show_devices.html
        ├── get_ACLs.html
        ├── set_ACLs.html
        ├── set_ACLs_submit.html
        └── message.html
```

Huh! Too much! No worries, most of these files are just automatically generated by Django while doing `startapp` and you then don't touch them - ![django](https://docs.djangoproject.com/en/2.2/intro/tutorial01/)
Important to you are the following files:
- /portal/urls.py
- /app/views.py
- /app/templates/index.html

### 1st step - Find out how does it work - urls.py
In urls.py we're creating **URLs** for our website - so where the content will be served. 
Corresponding function from views.py will be triggered once specific URL is accessed:
```python
urlpatterns = [
    path('admin/', admin.site.urls),
    path('', views.show_devices, name='show_devices'),
    path('delete_ACLs/', views.delete_ACLs, name='delete_ACLs'),
    path('get_ACLs/', views.get_ACLs, name='get_ACLs'),
    path('set_ACLs/', views.set_ACLs, name='set_ACLs'),
    path('set_ACLs_submit/', views.set_ACLs_submit, name='set_ACLs_submit')
]
```
So it means that if you access:  
http://localhost:8990/get_ACLs/ - function **get_ACLs()** from views.py will be executed  
http://localhost:8990/set_ACLs/ - function **set_ACLs()** from views.py will be executed  
http://localhost:8990/delete_ACLs/ - function **delete_ACLs()** from views.py will be executed  

### 2nd step - Find out how does it work - views.py
Here are our above-mentioned **functions**. 
The main purpose of these functions is to execute a **RESTCONF Request** to the NSO and pass Response to the **HTML template** to render it. 
```python
def delete_ACLs(request):
	response = requests.delete("http://172.16.238.2:8080/restconf/data/ACL_SERVICE",
                            auth=('admin', 'admin'), 
                            headers={'Content-type':'application/yang-data+json', 
                                     'Accept':'application/yang-data+json'})
	template = loader.get_template('message.html')
	return HttpResponse(template.render({'response':response}, request))
```
In this case we want to have ability to delete the ACL_SERVICE from NSO and pass the response (if it has been successfuly done) to the HTML Template.

### 3rd step - Find out how does it work - templates/message.html:
We have passed in the previous step response as a **response** variable to the custom HTML template. That is the pure HTML file that has to be written as per your taste and put into the /templates folder.
How to access this value and render it in this **HTML** file? By using: **{{ }}**.
```html
<div class="col-lg-12">
    <br>
    <h1>DEVNET Workshop #1827 - Demystifying NSO</h1>
    <br>
    <p>{{ response }}</p>
</div>
```
So the complete flow to for example - delete whole ACL_SERVICE from all devices is like that:
Accessing URL http://localhost:8990/delete_ACLs/ - trigger function `delete_ACLs(request)` - which will execute RESTCONF Request to NSO to delete whole ACL_SERVICE - and pass a RESTCONF Response to HTML Template `message.html` to render it.

You don't need to be a Web Developer to make responsive, nice websites - use snippets from the ![Bootstrap](https://getbootstrap.com)! It will make it for you!

### 4th step - Review portal functionality
Go to http://localhost:8990/ and check basic functionality of our custom UI portal:
- Show Devices
- Get ACLs
- Set ACLs
- Delete ACLs

Yeah! Delete ACLs - Carl is rescued!  

Done! You should see <Response [204]> - which from the REST API indicates as a Success

Adding new functionalities to it - is a matter of adding:
- new URL in urls.py
- new function with RESTCONF Request to NSO in views.py
- new HTML Template to render RESTCONF Response in /templates directory

---
<h4 align="center">[11/12]</h4>
<h4 align="center"> <a href="/readme/6.md"> :arrow_left: Service Deployment! </a> || <a href="/readme/8.md"> Summary! :arrow_right: </a> </h4>
